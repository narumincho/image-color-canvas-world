{"clientCode":"var M, h, X, C, J, Y, R, j, $, O, T = {}, ee = [], le = /acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i, I = Array.isArray;\nfunction b(_, e) {\n    for(var t in e)_[t] = e[t];\n    return _;\n}\nfunction _e(_) {\n    var e = _.parentNode;\n    e && e.removeChild(_);\n}\nfunction se(_, e, t) {\n    var i, n, r, l = {};\n    for(r in e)r == \"key\" ? i = e[r] : r == \"ref\" ? n = e[r] : l[r] = e[r];\n    if (arguments.length > 2 && (l.children = arguments.length > 3 ? M.call(arguments, 2) : t), typeof _ == \"function\" && _.defaultProps != null) for(r in _.defaultProps)l[r] === void 0 && (l[r] = _.defaultProps[r]);\n    return U(_, l, i, n, null);\n}\nfunction U(_, e, t, i, n) {\n    var r = {\n        type: _,\n        props: e,\n        key: t,\n        ref: i,\n        __k: null,\n        __: null,\n        __b: 0,\n        __e: null,\n        __d: void 0,\n        __c: null,\n        constructor: void 0,\n        __v: n ?? ++X,\n        __i: -1,\n        __u: 0\n    };\n    return n == null && h.vnode != null && h.vnode(r), r;\n}\nfunction N(_) {\n    return _.children;\n}\nfunction F(_, e) {\n    this.props = _, this.context = e;\n}\nfunction x(_, e) {\n    if (e == null) return _.__ ? x(_.__, _.__i + 1) : null;\n    for(var t; e < _.__k.length; e++)if ((t = _.__k[e]) != null && t.__e != null) return t.__e;\n    return typeof _.type == \"function\" ? x(_) : null;\n}\nfunction te(_) {\n    var e, t;\n    if ((_ = _.__) != null && _.__c != null) {\n        for(_.__e = _.__c.base = null, e = 0; e < _.__k.length; e++)if ((t = _.__k[e]) != null && t.__e != null) {\n            _.__e = _.__c.base = t.__e;\n            break;\n        }\n        return te(_);\n    }\n}\nfunction B(_) {\n    (!_.__d && (_.__d = !0) && C.push(_) && !H.__r++ || J !== h.debounceRendering) && ((J = h.debounceRendering) || Y)(H);\n}\nfunction H() {\n    var _, e, t, i, n, r, l, s;\n    for(C.sort(R); _ = C.shift();)_.__d && (e = C.length, i = void 0, r = (n = (t = _).__v).__e, l = [], s = [], t.__P && ((i = b({}, n)).__v = n.__v + 1, h.vnode && h.vnode(i), z(t.__P, i, n, t.__n, t.__P.namespaceURI, 32 & n.__u ? [\n        r\n    ] : null, l, r ?? x(n), !!(32 & n.__u), s), i.__v = n.__v, i.__.__k[i.__i] = i, re(l, i, s), i.__e != r && te(i)), C.length > e && C.sort(R));\n    H.__r = 0;\n}\nfunction ne(_, e, t, i, n, r, l, s, f, u, p) {\n    var o, m, c, v, g, y = i && i.__k || ee, a = e.length;\n    for(t.__d = f, ue(t, e, y), f = t.__d, o = 0; o < a; o++)(c = t.__k[o]) != null && typeof c != \"boolean\" && typeof c != \"function\" && (m = c.__i === -1 ? T : y[c.__i] || T, c.__i = o, z(_, c, m, n, r, l, s, f, u, p), v = c.__e, c.ref && m.ref != c.ref && (m.ref && q(m.ref, null, c), p.push(c.ref, c.__c || v, c)), g == null && v != null && (g = v), 65536 & c.__u || m.__k === c.__k ? (f && typeof c.type == \"string\" && !_.contains(f) && (f = x(m)), f = oe(c, f, _)) : typeof c.type == \"function\" && c.__d !== void 0 ? f = c.__d : v && (f = v.nextSibling), c.__d = void 0, c.__u &= -196609);\n    t.__d = f, t.__e = g;\n}\nfunction ue(_, e, t) {\n    var i, n, r, l, s, f = e.length, u = t.length, p = u, o = 0;\n    for(_.__k = [], i = 0; i < f; i++)l = i + o, (n = _.__k[i] = (n = e[i]) == null || typeof n == \"boolean\" || typeof n == \"function\" ? null : typeof n == \"string\" || typeof n == \"number\" || typeof n == \"bigint\" || n.constructor == String ? U(null, n, null, null, null) : I(n) ? U(N, {\n        children: n\n    }, null, null, null) : n.constructor === void 0 && n.__b > 0 ? U(n.type, n.props, n.key, n.ref ? n.ref : null, n.__v) : n) != null ? (n.__ = _, n.__b = _.__b + 1, s = fe(n, t, l, p), n.__i = s, r = null, s !== -1 && (p--, (r = t[s]) && (r.__u |= 131072)), r == null || r.__v === null ? (s == -1 && o--, typeof n.type != \"function\" && (n.__u |= 65536)) : s !== l && (s == l - 1 ? o = s - l : s == l + 1 ? o++ : s > l ? p > f - l ? o += s - l : o-- : s < l && o++, s !== i + o && (n.__u |= 65536))) : (r = t[l]) && r.key == null && r.__e && !(131072 & r.__u) && (r.__e == _.__d && (_.__d = x(r)), V(r, r, !1), t[l] = null, p--);\n    if (p) for(i = 0; i < u; i++)(r = t[i]) != null && !(131072 & r.__u) && (r.__e == _.__d && (_.__d = x(r)), V(r, r));\n}\nfunction oe(_, e, t) {\n    var i, n;\n    if (typeof _.type == \"function\") {\n        for(i = _.__k, n = 0; i && n < i.length; n++)i[n] && (i[n].__ = _, e = oe(i[n], e, t));\n        return e;\n    }\n    _.__e != e && (t.insertBefore(_.__e, e || null), e = _.__e);\n    do e = e && e.nextSibling;\n    while (e != null && e.nodeType === 8)\n    return e;\n}\nfunction fe(_, e, t, i) {\n    var n = _.key, r = _.type, l = t - 1, s = t + 1, f = e[t];\n    if (f === null || f && n == f.key && r === f.type && !(131072 & f.__u)) return t;\n    if (i > (f != null && !(131072 & f.__u) ? 1 : 0)) for(; l >= 0 || s < e.length;){\n        if (l >= 0) {\n            if ((f = e[l]) && !(131072 & f.__u) && n == f.key && r === f.type) return l;\n            l--;\n        }\n        if (s < e.length) {\n            if ((f = e[s]) && !(131072 & f.__u) && n == f.key && r === f.type) return s;\n            s++;\n        }\n    }\n    return -1;\n}\nfunction K(_, e, t) {\n    e[0] === \"-\" ? _.setProperty(e, t ?? \"\") : _[e] = t == null ? \"\" : typeof t != \"number\" || le.test(e) ? t : t + \"px\";\n}\nfunction W(_, e, t, i, n) {\n    var r;\n    e: if (e === \"style\") if (typeof t == \"string\") _.style.cssText = t;\n    else {\n        if (typeof i == \"string\" && (_.style.cssText = i = \"\"), i) for(e in i)t && e in t || K(_.style, e, \"\");\n        if (t) for(e in t)i && t[e] === i[e] || K(_.style, e, t[e]);\n    }\n    else if (e[0] === \"o\" && e[1] === \"n\") r = e !== (e = e.replace(/(PointerCapture)$|Capture$/i, \"$1\")), e = e.toLowerCase() in _ || e === \"onFocusOut\" || e === \"onFocusIn\" ? e.toLowerCase().slice(2) : e.slice(2), _.l || (_.l = {}), _.l[e + r] = t, t ? i ? t.u = i.u : (t.u = j, _.addEventListener(e, r ? O : $, r)) : _.removeEventListener(e, r ? O : $, r);\n    else {\n        if (n == \"http://www.w3.org/2000/svg\") e = e.replace(/xlink(H|:h)/, \"h\").replace(/sName$/, \"s\");\n        else if (e != \"width\" && e != \"height\" && e != \"href\" && e != \"list\" && e != \"form\" && e != \"tabIndex\" && e != \"download\" && e != \"rowSpan\" && e != \"colSpan\" && e != \"role\" && e != \"popover\" && e in _) try {\n            _[e] = t ?? \"\";\n            break e;\n        } catch  {}\n        typeof t == \"function\" || (t == null || t === !1 && e[4] !== \"-\" ? _.removeAttribute(e) : _.setAttribute(e, e == \"popover\" && t == 1 ? \"\" : t));\n    }\n}\nfunction Q(_) {\n    return function(e) {\n        if (this.l) {\n            var t = this.l[e.type + _];\n            if (e.t == null) e.t = j++;\n            else if (e.t < t.u) return;\n            return t(h.event ? h.event(e) : e);\n        }\n    };\n}\nfunction z(_, e, t, i, n, r, l, s, f, u) {\n    var p, o, m, c, v, g, y, a, d, P, w, D, S, G, E, A, k = e.type;\n    if (e.constructor !== void 0) return null;\n    128 & t.__u && (f = !!(32 & t.__u), r = [\n        s = e.__e = t.__e\n    ]), (p = h.__b) && p(e);\n    e: if (typeof k == \"function\") try {\n        if (a = e.props, d = \"prototype\" in k && k.prototype.render, P = (p = k.contextType) && i[p.__c], w = p ? P ? P.props.value : p.__ : i, t.__c ? y = (o = e.__c = t.__c).__ = o.__E : (d ? e.__c = o = new k(a, w) : (e.__c = o = new F(a, w), o.constructor = k, o.render = ae), P && P.sub(o), o.props = a, o.state || (o.state = {}), o.context = w, o.__n = i, m = o.__d = !0, o.__h = [], o._sb = []), d && o.__s == null && (o.__s = o.state), d && k.getDerivedStateFromProps != null && (o.__s == o.state && (o.__s = b({}, o.__s)), b(o.__s, k.getDerivedStateFromProps(a, o.__s))), c = o.props, v = o.state, o.__v = e, m) d && k.getDerivedStateFromProps == null && o.componentWillMount != null && o.componentWillMount(), d && o.componentDidMount != null && o.__h.push(o.componentDidMount);\n        else {\n            if (d && k.getDerivedStateFromProps == null && a !== c && o.componentWillReceiveProps != null && o.componentWillReceiveProps(a, w), !o.__e && (o.shouldComponentUpdate != null && o.shouldComponentUpdate(a, o.__s, w) === !1 || e.__v === t.__v)) {\n                for(e.__v !== t.__v && (o.props = a, o.state = o.__s, o.__d = !1), e.__e = t.__e, e.__k = t.__k, e.__k.forEach(function(L) {\n                    L && (L.__ = e);\n                }), D = 0; D < o._sb.length; D++)o.__h.push(o._sb[D]);\n                o._sb = [], o.__h.length && l.push(o);\n                break e;\n            }\n            o.componentWillUpdate != null && o.componentWillUpdate(a, o.__s, w), d && o.componentDidUpdate != null && o.__h.push(function() {\n                o.componentDidUpdate(c, v, g);\n            });\n        }\n        if (o.context = w, o.props = a, o.__P = _, o.__e = !1, S = h.__r, G = 0, d) {\n            for(o.state = o.__s, o.__d = !1, S && S(e), p = o.render(o.props, o.state, o.context), E = 0; E < o._sb.length; E++)o.__h.push(o._sb[E]);\n            o._sb = [];\n        } else do o.__d = !1, S && S(e), p = o.render(o.props, o.state, o.context), o.state = o.__s;\n        while (o.__d && ++G < 25)\n        o.state = o.__s, o.getChildContext != null && (i = b(b({}, i), o.getChildContext())), d && !m && o.getSnapshotBeforeUpdate != null && (g = o.getSnapshotBeforeUpdate(c, v)), ne(_, I(A = p != null && p.type === N && p.key == null ? p.props.children : p) ? A : [\n            A\n        ], e, t, i, n, r, l, s, f, u), o.base = e.__e, e.__u &= -161, o.__h.length && l.push(o), y && (o.__E = o.__ = null);\n    } catch (L) {\n        e.__v = null, f || r != null ? (e.__e = s, e.__u |= f ? 160 : 32, r[r.indexOf(s)] = null) : (e.__e = t.__e, e.__k = t.__k), h.__e(L, e, t);\n    }\n    else r == null && e.__v === t.__v ? (e.__k = t.__k, e.__e = t.__e) : e.__e = pe(t.__e, e, t, i, n, r, l, f, u);\n    (p = h.diffed) && p(e);\n}\nfunction re(_, e, t) {\n    e.__d = void 0;\n    for(var i = 0; i < t.length; i++)q(t[i], t[++i], t[++i]);\n    h.__c && h.__c(e, _), _.some(function(n) {\n        try {\n            _ = n.__h, n.__h = [], _.some(function(r) {\n                r.call(n);\n            });\n        } catch (r) {\n            h.__e(r, n.__v);\n        }\n    });\n}\nfunction pe(_, e, t, i, n, r, l, s, f) {\n    var u, p, o, m, c, v, g, y = t.props, a = e.props, d = e.type;\n    if (d === \"svg\" ? n = \"http://www.w3.org/2000/svg\" : d === \"math\" ? n = \"http://www.w3.org/1998/Math/MathML\" : n || (n = \"http://www.w3.org/1999/xhtml\"), r != null) {\n        for(u = 0; u < r.length; u++)if ((c = r[u]) && \"setAttribute\" in c == !!d && (d ? c.localName === d : c.nodeType === 3)) {\n            _ = c, r[u] = null;\n            break;\n        }\n    }\n    if (_ == null) {\n        if (d === null) return document.createTextNode(a);\n        _ = document.createElementNS(n, d, a.is && a), r = null, s = !1;\n    }\n    if (d === null) y === a || s && _.data === a || (_.data = a);\n    else {\n        if (r = r && M.call(_.childNodes), y = t.props || T, !s && r != null) for(y = {}, u = 0; u < _.attributes.length; u++)y[(c = _.attributes[u]).name] = c.value;\n        for(u in y)if (c = y[u], u != \"children\") {\n            if (u == \"dangerouslySetInnerHTML\") o = c;\n            else if (u !== \"key\" && !(u in a)) {\n                if (u == \"value\" && \"defaultValue\" in a || u == \"checked\" && \"defaultChecked\" in a) continue;\n                W(_, u, null, c, n);\n            }\n        }\n        for(u in a)c = a[u], u == \"children\" ? m = c : u == \"dangerouslySetInnerHTML\" ? p = c : u == \"value\" ? v = c : u == \"checked\" ? g = c : u === \"key\" || s && typeof c != \"function\" || y[u] === c || W(_, u, c, y[u], n);\n        if (p) s || o && (p.__html === o.__html || p.__html === _.innerHTML) || (_.innerHTML = p.__html), e.__k = [];\n        else if (o && (_.innerHTML = \"\"), ne(_, I(m) ? m : [\n            m\n        ], e, t, i, d === \"foreignObject\" ? \"http://www.w3.org/1999/xhtml\" : n, r, l, r ? r[0] : t.__k && x(t, 0), s, f), r != null) for(u = r.length; u--;)r[u] != null && _e(r[u]);\n        s || (u = \"value\", v !== void 0 && (v !== _[u] || d === \"progress\" && !v || d === \"option\" && v !== y[u]) && W(_, u, v, y[u], n), u = \"checked\", g !== void 0 && g !== _[u] && W(_, u, g, y[u], n));\n    }\n    return _;\n}\nfunction q(_, e, t) {\n    try {\n        typeof _ == \"function\" ? _(e) : _.current = e;\n    } catch (i) {\n        h.__e(i, t);\n    }\n}\nfunction V(_, e, t) {\n    var i, n;\n    if (h.unmount && h.unmount(_), (i = _.ref) && (i.current && i.current !== _.__e || q(i, null, e)), (i = _.__c) != null) {\n        if (i.componentWillUnmount) try {\n            i.componentWillUnmount();\n        } catch (r) {\n            h.__e(r, e);\n        }\n        i.base = i.__P = null;\n    }\n    if (i = _.__k) for(n = 0; n < i.length; n++)i[n] && V(i[n], e, t || typeof _.type != \"function\");\n    t || _.__e == null || _e(_.__e), _.__c = _.__ = _.__e = _.__d = void 0;\n}\nfunction ae(_, e, t) {\n    return this.constructor(_, t);\n}\nfunction de(_, e, t) {\n    var i, n, r, l;\n    h.__ && h.__(_, e), n = (i = typeof t == \"function\") ? null : t && t.__k || e.__k, r = [], l = [], z(e, _ = (!i && t || e).__k = se(N, null, [\n        _\n    ]), n || T, T, e.namespaceURI, !i && t ? [\n        t\n    ] : n ? null : e.firstChild ? M.call(e.childNodes) : null, r, !i && t ? t : n ? n.__e : e.firstChild, i, l), re(r, _, l);\n}\nM = ee.slice, h = {\n    __e: function(_, e, t, i) {\n        for(var n, r, l; e = e.__;)if ((n = e.__c) && !n.__) try {\n            if ((r = n.constructor) && r.getDerivedStateFromError != null && (n.setState(r.getDerivedStateFromError(_)), l = n.__d), n.componentDidCatch != null && (n.componentDidCatch(_, i || {}), l = n.__d), l) return n.__E = n;\n        } catch (s) {\n            _ = s;\n        }\n        throw _;\n    }\n}, X = 0, F.prototype.setState = function(_, e) {\n    var t;\n    t = this.__s != null && this.__s !== this.state ? this.__s : this.__s = b({}, this.state), typeof _ == \"function\" && (_ = _(b({}, t), this.props)), _ && b(t, _), _ != null && this.__v && (e && this._sb.push(e), B(this));\n}, F.prototype.forceUpdate = function(_) {\n    this.__v && (this.__e = !0, _ && this.__h.push(_), B(this));\n}, F.prototype.render = N, C = [], Y = typeof Promise == \"function\" ? Promise.prototype.then.bind(Promise.resolve()) : setTimeout, R = function(_, e) {\n    return _.__v.__b - e.__v.__b;\n}, H.__r = 0, j = 0, $ = Q(!1), O = Q(!0), 0;\nvar c, r, d, b1, v = 0, x1 = [], o = h, g = o.__b, C1 = o.__r, A = o.diffed, D = o.__c, F1 = o.unmount, k = o.__;\nfunction l(t, _) {\n    o.__h && o.__h(r, t, v || _), v = 0;\n    var u = r.__H || (r.__H = {\n        __: [],\n        __h: []\n    });\n    return t >= u.__.length && u.__.push({}), u.__[t];\n}\nfunction B1(t) {\n    return v = 1, I1(U1, t);\n}\nfunction I1(t, _, u) {\n    var n = l(c++, 2);\n    if (n.t = t, !n.__c && (n.__ = [\n        u ? u(_) : U1(void 0, _),\n        function(a) {\n            var f = n.__N ? n.__N[0] : n.__[0], s = n.t(f, a);\n            f !== s && (n.__N = [\n                s,\n                n.__[1]\n            ], n.__c.setState({}));\n        }\n    ], n.__c = r, !r.u)) {\n        var i = function(a, f, s) {\n            if (!n.__c.__H) return !0;\n            var m = n.__c.__H.__.filter(function(e) {\n                return !!e.__c;\n            });\n            if (m.every(function(e) {\n                return !e.__N;\n            })) return !h || h.call(this, a, f, s);\n            var N = !1;\n            return m.forEach(function(e) {\n                if (e.__N) {\n                    var P = e.__[0];\n                    e.__ = e.__N, e.__N = void 0, P !== e.__[0] && (N = !0);\n                }\n            }), !(!N && n.__c.props === a) && (!h || h.call(this, a, f, s));\n        };\n        r.u = !0;\n        var h = r.shouldComponentUpdate, y = r.componentWillUpdate;\n        r.componentWillUpdate = function(a, f, s) {\n            if (this.__e) {\n                var m = h;\n                h = void 0, i(a, f, s), h = m;\n            }\n            y && y.call(this, a, f, s);\n        }, r.shouldComponentUpdate = i;\n    }\n    return n.__N || n.__;\n}\nfunction S() {\n    for(var t; t = x1.shift();)if (t.__P && t.__H) try {\n        t.__H.__h.forEach(p), t.__H.__h.forEach(H1), t.__H.__h = [];\n    } catch (_) {\n        t.__H.__h = [], o.__e(_, t.__v);\n    }\n}\no.__b = function(t) {\n    r = null, g && g(t);\n}, o.__ = function(t, _) {\n    t && _.__k && _.__k.__m && (t.__m = _.__k.__m), k && k(t, _);\n}, o.__r = function(t) {\n    C1 && C1(t), c = 0;\n    var _ = (r = t.__c).__H;\n    _ && (d === r ? (_.__h = [], r.__h = [], _.__.forEach(function(u) {\n        u.__N && (u.__ = u.__N), u.i = u.__N = void 0;\n    })) : (_.__h.forEach(p), _.__h.forEach(H1), _.__h = [], c = 0)), d = r;\n}, o.diffed = function(t) {\n    A && A(t);\n    var _ = t.__c;\n    _ && _.__H && (_.__H.__h.length && (x1.push(_) !== 1 && b1 === o.requestAnimationFrame || ((b1 = o.requestAnimationFrame) || W1)(S)), _.__H.__.forEach(function(u) {\n        u.i && (u.__H = u.i), u.i = void 0;\n    })), d = r = null;\n}, o.__c = function(t, _) {\n    _.some(function(u) {\n        try {\n            u.__h.forEach(p), u.__h = u.__h.filter(function(n) {\n                return !n.__ || H1(n);\n            });\n        } catch (n) {\n            _.some(function(i) {\n                i.__h && (i.__h = []);\n            }), _ = [], o.__e(n, u.__v);\n        }\n    }), D && D(t, _);\n}, o.unmount = function(t) {\n    F1 && F1(t);\n    var _, u = t.__c;\n    u && u.__H && (u.__H.__.forEach(function(n) {\n        try {\n            p(n);\n        } catch (i) {\n            _ = i;\n        }\n    }), u.__H = void 0, _ && o.__e(_, u.__v));\n};\nvar q1 = typeof requestAnimationFrame == \"function\";\nfunction W1(t) {\n    var _, u = function() {\n        clearTimeout(n), q1 && cancelAnimationFrame(_), setTimeout(t);\n    }, n = setTimeout(u, 100);\n    q1 && (_ = requestAnimationFrame(u));\n}\nfunction p(t) {\n    var _ = r, u = t.__c;\n    typeof u == \"function\" && (t.__c = void 0, u()), r = _;\n}\nfunction H1(t) {\n    var _ = r;\n    t.__c = t.__(), r = _;\n}\nfunction U1(t, _) {\n    return typeof _ == \"function\" ? _(t) : _;\n}\nconst appDomId = \"image-color-canvas-world-app\";\nconst handleResizeApp = (setAppHeightPerWidth)=>{\n    const resizeObserver = new ResizeObserver((entries)=>{\n        for (const entry of entries){\n            setAppHeightPerWidth(entry.target.clientHeight / entry.target.clientWidth);\n        }\n    });\n    const appDomElement = document.getElementById(appDomId);\n    if (appDomElement !== null) {\n        resizeObserver.observe(appDomElement);\n        return;\n    }\n    console.log(\"domから取得できず\");\n};\nconst initialize = (setFileUrlList, setAppHeightPerWidth)=>{\n    const getFiles = async ()=>{\n        const urlList = await getFileList();\n        setFileUrlList(await Promise.all(urlList.map((url)=>{\n            return getImageMainColor(url);\n        })));\n        console.log(\"10秒に一回する処理!\", urlList);\n    };\n    setInterval(getFiles, 10000);\n    getFiles();\n    setTimeout(()=>{\n        handleResizeApp(setAppHeightPerWidth);\n    }, 0);\n    console.log(\"初期化しました\");\n    return getFiles;\n};\nconst getFileList = async ()=>{\n    const response = await fetch(\"/imageNameList\");\n    const result = await response.json();\n    return result.fileNames.map((fileName)=>`/image/${fileName}`);\n};\nconst cache = new Map();\nconst getImageMainColor = (url)=>new Promise((resolve)=>{\n        const resultFromCache = cache.get(url);\n        if (resultFromCache !== undefined) {\n            resolve(resultFromCache);\n            return;\n        }\n        const image = new Image();\n        image.onload = ()=>{\n            console.log(\"画像を読み込めました\", image);\n            const canvasElement = document.createElement(\"canvas\");\n            canvasElement.width = image.width;\n            canvasElement.height = image.height;\n            const context = canvasElement.getContext(\"2d\");\n            context.drawImage(image, 0, 0);\n            const imageData = context.getImageData(0, 0, image.width, image.height);\n            const mainHue = imageDataGetModeHue(imageData);\n            const result = {\n                url,\n                hue: mainHue,\n                light: imageDataGetModeLight(imageData),\n                heightPerWidth: imageData.height / imageData.width\n            };\n            cache.set(url, result);\n            resolve(result);\n        };\n        image.src = url;\n    });\nconst imageDataGetModeHue = (imageData)=>{\n    const map = new Map();\n    for(let i = 0; i < imageData.data.length / 4; i += 1){\n        const r = imageData.data[i * 4 + 0];\n        const g = imageData.data[i * 4 + 1];\n        const b = imageData.data[i * 4 + 2];\n        const key = Math.floor(rgbColorToHue({\n            r,\n            b,\n            g\n        }) / 10) * 10;\n        const before = map.get(key);\n        map.set(key, before === undefined ? 1 : before + 1);\n    }\n    console.log(\"map\", map);\n    return maxMapKey(map, new Set([\n        0\n    ])) ?? 23;\n};\nconst imageDataGetModeLight = (imageData)=>{\n    let lightSum = 0;\n    for(let i = 0; i < imageData.data.length / 4; i += 1){\n        const r = imageData.data[i * 4 + 0];\n        const g = imageData.data[i * 4 + 1];\n        const b = imageData.data[i * 4 + 2];\n        lightSum += rgbToLight({\n            r,\n            b,\n            g\n        });\n    }\n    const pixelCount = imageData.width * imageData.height;\n    const light = lightSum / pixelCount;\n    console.log({\n        light\n    });\n    return light;\n};\nconst maxMapKey = (map, exclude)=>{\n    return [\n        ...map\n    ].reduce((beforeMax, [k, v])=>{\n        if (exclude.has(k)) {\n            return beforeMax;\n        }\n        if (beforeMax === undefined) {\n            return {\n                key: k,\n                value: v\n            };\n        }\n        if (beforeMax.value < v) {\n            return {\n                key: k,\n                value: v\n            };\n        }\n        return beforeMax;\n    }, undefined)?.key;\n};\nconst rgbColorToHue = (color)=>{\n    const rawHue = rgbColorToRawHue(color);\n    if (rawHue < 0) {\n        return Math.floor(rawHue) + 360;\n    }\n    return Math.floor(rawHue);\n};\nconst rgbColorToRawHue = (color)=>{\n    if (color.g < color.r && color.b < color.r) {\n        return 60 * ((color.g - color.b) / (color.r - Math.min(color.g, color.b)));\n    }\n    if (color.r < color.g && color.b < color.g) {\n        return 60 * ((color.b - color.r) / (color.g - Math.min(color.r, color.b))) + 120;\n    }\n    if (color.r < color.b && color.g < color.b) {\n        return 60 * ((color.r - color.g) / (color.b - Math.min(color.r, color.g))) + 240;\n    }\n    return 0;\n};\nconst rgbToLight = (color)=>{\n    return (Math.max(color.r, color.g, color.b) + Math.min(color.r, color.g, color.b)) / 2 / 256;\n};\nconst getUploadingMessage = (uploadingState)=>{\n    switch(uploadingState.type){\n        case \"uploading\":\n            return \"アップロード中... \" + uploadingState.current.toString() + \"/\" + uploadingState.all.toString();\n        case \"none\":\n            return \"\";\n        case \"complete\":\n            return uploadingState.fileCount.toString() + \"つの画像をアップロードしました\";\n    }\n};\nconst App = ()=>{\n    const [fileNameUrl, setFileUrlList] = B1([]);\n    const [uploadingState, setUploadingState] = B1({\n        type: \"none\"\n    });\n    const [appHeightPerWidth, setAppHeightPerWidth] = B1(1);\n    const getFiles = initialize(setFileUrlList, setAppHeightPerWidth);\n    const onInputFile = (e)=>{\n        const files = e.currentTarget.files;\n        if (files === null) {\n            return;\n        }\n        setUploadingState({\n            type: \"uploading\",\n            current: 0,\n            all: files.length\n        });\n        Promise.all([\n            ...files\n        ].map(async (file)=>{\n            return fetch(\"/uploadImage\", {\n                method: \"POST\",\n                body: await file.arrayBuffer(),\n                headers: new Headers({\n                    \"content-type\": file.type\n                })\n            }).then(()=>{\n                setUploadingState((before)=>{\n                    if (before.type !== \"uploading\") {\n                        return before;\n                    }\n                    return {\n                        type: \"uploading\",\n                        all: before.all,\n                        current: before.current + 1\n                    };\n                });\n                console.log(\"ok\");\n            });\n        })).then(()=>{\n            setUploadingState((before)=>({\n                    type: \"complete\",\n                    fileCount: before.type === \"uploading\" ? before.all : -1\n                }));\n            getFiles();\n        });\n    };\n    const calcY = (light, height)=>{\n        return (1 - light) * 360 * appHeightPerWidth - height / 2;\n    };\n    return se(\"div\", {\n        class: \"container\",\n        id: appDomId\n    }, se(\"svg\", {\n        viewBox: \"0 0 360 \" + (360 * appHeightPerWidth).toString(),\n        class: \"mainView\"\n    }, fileNameUrl.map((item)=>{\n        const width = 20 / item.heightPerWidth;\n        const x = item.hue - width / 2;\n        return se(\"g\", null, se(\"rect\", {\n            fill: `hsl(${item.hue}, 80%, ${Math.floor(item.light * 100)}%)`,\n            x: x - 1,\n            y: calcY(item.light, 20) - 1,\n            width: width + 2,\n            height: 20 + 2\n        }), se(\"image\", {\n            href: item.url,\n            x: x,\n            y: calcY(item.light, 20),\n            width: width,\n            height: 20\n        }));\n    })), se(\"div\", {\n        class: \"fileInputContainer\"\n    }, uploadingState.type !== \"uploading\" && !window.location.hash.includes(\"hide\") ? se(\"input\", {\n        class: \"fileInput\",\n        type: \"file\",\n        accept: \"image/png, image/jpeg\",\n        multiple: true,\n        onInput: onInputFile\n    }) : undefined, se(\"div\", {\n        class: \"message\"\n    }, getUploadingMessage(uploadingState))));\n};\nconst rootElement = document.createElement(\"div\");\ndocument.body.appendChild(rootElement);\nde(se(App, null), rootElement);\nconsole.log(\"loaded\");\n","clientCodeHash":"b2675ffea2fde3937ce73ab2ef8106bacc1b427d40396f85115744787bace8df","styleCss":"html,\nbody {\n  padding: 0;\n  margin: 0;\n  color: white;\n  background-color: black;\n  height: 100%;\n}\n\na {\n  color: inherit;\n  text-decoration: none;\n}\n\n* {\n  box-sizing: border-box;\n}\n\n.container {\n  display: grid;\n\n  height: 100vh;\n}\n\n.mainView {\n  width: 100%;\n  height: 100%;\n\n  grid-column: 1 / 2;\n  grid-row: 1 / 2;\n}\n\n.fileInputContainer {\n  width: 100%;\n\n  grid-column: 1 / 2;\n  grid-row: 1 / 2;\n\n  align-self: flex-end;\n\n  display: flex;\n  justify-content: space-between;\n\n  height: 48px;\n}\n\n.fileInput {\n  flex-grow: 1;\n\n  align-self: stretch;\n}\n\n.message {\n  align-self: center;\n  padding-right: 16px;\n}","styleCssHash":"aa1394cf7dc9c8ba547f0f2e8b652ed07deb1b12ea0890656741bea99da2a2e4"}